name: Product Pack Validation

on:
  pull_request:
  push:
    branches:
      - main

jobs:
  validate-pack:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: pip install pyyaml

      - name: Fetch validator and rules
        run: |
          mkdir -p tools rules
          curl -fsSL -o tools/t4l_validate_pack.py \
            https://raw.githubusercontent.com/tech4life-beyond/product-creation-pipeline/main/tools/t4l_validate_pack.py
          curl -fsSL -o rules/product_pack_rules.yml \
            https://raw.githubusercontent.com/tech4life-beyond/product-creation-pipeline/main/rules/product_pack_rules.yml

      - name: Validate product pack
        run: python tools/t4l_validate_pack.py .
